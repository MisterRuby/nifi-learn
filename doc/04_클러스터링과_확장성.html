<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NiFi í´ëŸ¬ìŠ¤í„°ë§ê³¼ í™•ì¥ì„±</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .content {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
            font-size: 2.5em;
        }
        h2 {
            color: #34495e;
            margin-top: 35px;
            font-size: 1.8em;
        }
        h3 {
            color: #555;
            margin-top: 25px;
            font-size: 1.3em;
        }
        .cluster-diagram {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: center;
        }
        .node-box {
            display: inline-block;
            background: white;
            padding: 20px;
            margin: 10px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 150px;
            transition: transform 0.3s;
        }
        .node-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .primary-node {
            border: 3px solid #4caf50;
            background: #e8f5e9;
        }
        .worker-node {
            border: 2px solid #2196f3;
        }
        .zookeeper-node {
            border: 2px solid #ff9800;
            background: #fff3e0;
        }
        code {
            background: #f4f4f4;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #e83e8c;
        }
        pre {
            background: #2d2d2d;
            color: #fff;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.5;
            margin: 20px 0;
        }
        .config-section {
            background: #f8f9fa;
            padding: 25px;
            border-left: 5px solid #667eea;
            border-radius: 8px;
            margin: 20px 0;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s;
        }
        .feature-card:hover {
            border-color: #667eea;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.1);
        }
        .arrow {
            font-size: 1.5em;
            color: #667eea;
            margin: 0 10px;
        }
        .info-box {
            background: #e7f5ff;
            border: 2px solid #339af0;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .warning-box {
            background: #fff4e6;
            border: 2px solid #ff9800;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .success-box {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
        }
        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        .scaling-strategy {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .metric-value {
            font-size: 2em;
            color: #667eea;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="content">
            <h1>ğŸŒ NiFi í´ëŸ¬ìŠ¤í„°ë§ê³¼ í™•ì¥ì„±</h1>

            <div class="info-box">
                <h2>ğŸ“Š í´ëŸ¬ìŠ¤í„°ë§ ê°œìš”</h2>
                <p>Apache NiFiëŠ” Zero-Leader Clustering ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí•˜ì—¬ ëª¨ë“  ë…¸ë“œê°€ ë™ë“±í•œ ê¶Œí•œì„ ê°€ì§€ë©°, 
                ìë™ ë¡œë“œ ë°¸ëŸ°ì‹±ê³¼ í˜ì¼ì˜¤ë²„ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ëŠ” ìˆ˜í‰ í™•ì¥ì´ ê°€ëŠ¥í•˜ë©°, 
                ë…¸ë“œ ì¶”ê°€/ì œê±°ê°€ ë™ì ìœ¼ë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
            </div>

            <h2>ğŸ—ï¸ í´ëŸ¬ìŠ¤í„° ì•„í‚¤í…ì²˜</h2>
            
            <div class="cluster-diagram">
                <h3>NiFi í´ëŸ¬ìŠ¤í„° êµ¬ì„±ë„</h3>
                
                <div style="margin: 30px 0;">
                    <div class="node-box primary-node">
                        <strong>ğŸ¯ Primary Node</strong><br>
                        <small>Cluster Coordinator</small><br>
                        <code>nifi-01:8443</code>
                    </div>
                    <span class="arrow">â†”</span>
                    <div style="display: inline-block; vertical-align: top;">
                        <div class="node-box worker-node">
                            <strong>ğŸ’» Node 2</strong><br>
                            <small>Worker Node</small><br>
                            <code>nifi-02:8443</code>
                        </div>
                        <div class="node-box worker-node">
                            <strong>ğŸ’» Node 3</strong><br>
                            <small>Worker Node</small><br>
                            <code>nifi-03:8443</code>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <div class="node-box zookeeper-node">
                        <strong>ğŸ“¡ ZooKeeper Ensemble</strong><br>
                        <small>Coordination Service</small><br>
                        <code>zk1:2181, zk2:2181, zk3:2181</code>
                    </div>
                </div>
            </div>

            <h2>âš™ï¸ í´ëŸ¬ìŠ¤í„° ì„¤ì •</h2>

            <div class="config-section">
                <h3>1. ZooKeeper ì„¤ì •</h3>
                <pre><code># zoo.cfg
tickTime=2000
dataDir=/var/zookeeper/data
clientPort=2181
initLimit=10
syncLimit=5
server.1=zk1:2888:3888
server.2=zk2:2888:3888
server.3=zk3:2888:3888

# ZooKeeper ì‹œì‘
./zkServer.sh start</code></pre>
            </div>

            <div class="config-section">
                <h3>2. NiFi í´ëŸ¬ìŠ¤í„° ì„¤ì • (nifi.properties)</h3>
                <pre><code># í´ëŸ¬ìŠ¤í„° í™œì„±í™”
nifi.cluster.is.node=true
nifi.cluster.node.address=nifi-01.example.com
nifi.cluster.node.protocol.port=11443
nifi.cluster.node.load.balance.port=6342

# ZooKeeper ì—°ê²°
nifi.zookeeper.connect.string=zk1:2181,zk2:2181,zk3:2181
nifi.zookeeper.root.node=/nifi

# í´ëŸ¬ìŠ¤í„° í”Œë¡œìš° ì„ ì¶œ
nifi.cluster.flow.election.max.wait.time=5 mins

# Site-to-Site ì„¤ì •
nifi.remote.input.host=nifi-01.example.com
nifi.remote.input.secure=true
nifi.remote.input.socket.port=10443</code></pre>
            </div>

            <div class="config-section">
                <h3>3. ìƒíƒœ ê´€ë¦¬ ì„¤ì • (state-management.xml)</h3>
                <pre><code>&lt;stateManagement&gt;
    &lt;local-provider&gt;
        &lt;id&gt;local-provider&lt;/id&gt;
        &lt;class&gt;org.apache.nifi.controller.state.providers.local.WriteAheadLocalStateProvider&lt;/class&gt;
        &lt;property name="Directory"&gt;./state/local&lt;/property&gt;
    &lt;/local-provider&gt;
    
    &lt;cluster-provider&gt;
        &lt;id&gt;zk-provider&lt;/id&gt;
        &lt;class&gt;org.apache.nifi.controller.state.providers.zookeeper.ZooKeeperStateProvider&lt;/class&gt;
        &lt;property name="Connect String"&gt;zk1:2181,zk2:2181,zk3:2181&lt;/property&gt;
        &lt;property name="Root Node"&gt;/nifi&lt;/property&gt;
    &lt;/cluster-provider&gt;
&lt;/stateManagement&gt;</code></pre>
            </div>

            <h2>ğŸš€ í™•ì¥ì„± ì „ëµ</h2>

            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ“ˆ ìˆ˜í‰ í™•ì¥ (Scale Out)</h3>
                    <p><strong>ë…¸ë“œ ì¶”ê°€ë¥¼ í†µí•œ í™•ì¥</strong></p>
                    <ul>
                        <li>ì²˜ë¦¬ ìš©ëŸ‰ ì„ í˜• ì¦ê°€</li>
                        <li>ìë™ ë¡œë“œ ë°¸ëŸ°ì‹±</li>
                        <li>ë¬´ì¤‘ë‹¨ ë…¸ë“œ ì¶”ê°€</li>
                        <li>ìµœëŒ€ ìˆ˜ë°± ê°œ ë…¸ë“œ ì§€ì›</li>
                    </ul>
                    <div class="success-box">
                        <strong>ê¶Œì¥ ì‚¬í•­:</strong> ì´ˆê¸° 3-5ê°œ ë…¸ë“œë¡œ ì‹œì‘í•˜ì—¬ í•„ìš”ì— ë”°ë¼ í™•ì¥
                    </div>
                </div>

                <div class="feature-card">
                    <h3>ğŸ“Š ìˆ˜ì§ í™•ì¥ (Scale Up)</h3>
                    <p><strong>ë…¸ë“œ ë¦¬ì†ŒìŠ¤ ì¦ì„¤</strong></p>
                    <ul>
                        <li>CPU ì½”ì–´ ì¶”ê°€</li>
                        <li>ë©”ëª¨ë¦¬ ì¦ì„¤ (8GB â†’ 32GB+)</li>
                        <li>SSD ìŠ¤í† ë¦¬ì§€ ì—…ê·¸ë ˆì´ë“œ</li>
                        <li>ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì¦ê°€</li>
                    </ul>
                    <pre><code># JVM í™ ë©”ëª¨ë¦¬ ì„¤ì •
java.arg.2=-Xms8g
java.arg.3=-Xmx8g</code></pre>
                </div>
            </div>

            <h2>ğŸ”„ ë¡œë“œ ë°¸ëŸ°ì‹±</h2>

            <div class="scaling-strategy">
                <h3>Connection ë¡œë“œ ë°¸ëŸ°ì‹± ì „ëµ</h3>
                <table>
                    <thead>
                        <tr>
                            <th>ì „ëµ</th>
                            <th>ì„¤ëª…</th>
                            <th>ì‚¬ìš© ì‚¬ë¡€</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Round Robin</strong></td>
                            <td>ìˆœí™˜ ë°©ì‹ìœ¼ë¡œ ê· ë“± ë¶„ë°°</td>
                            <td>ì¼ë°˜ì ì¸ ë¶€í•˜ ë¶„ì‚°</td>
                        </tr>
                        <tr>
                            <td><strong>Single Node</strong></td>
                            <td>í•˜ë‚˜ì˜ ë…¸ë“œì—ë§Œ ì „ì†¡</td>
                            <td>ìˆœì„œ ë³´ì¥ì´ í•„ìš”í•œ ê²½ìš°</td>
                        </tr>
                        <tr>
                            <td><strong>Partition by Attribute</strong></td>
                            <td>ì†ì„± ê¸°ë°˜ íŒŒí‹°ì…”ë‹</td>
                            <td>ë°ì´í„° ì§€ì—­ì„± ë³´ì¥</td>
                        </tr>
                        <tr>
                            <td><strong>Do Not Load Balance</strong></td>
                            <td>ë¡œë“œ ë°¸ëŸ°ì‹± ë¹„í™œì„±í™”</td>
                            <td>ë¡œì»¬ ì²˜ë¦¬ë§Œ í•„ìš”í•œ ê²½ìš°</td>
                        </tr>
                    </tbody>
                </table>

                <pre><code># Connection ë¡œë“œ ë°¸ëŸ°ì‹± ì„¤ì • ì˜ˆì‹œ
Load Balance Strategy: Round Robin
Load Balance Compression: Do not compress
Load Balance Max Thread Count: 8</code></pre>
            </div>

            <h2>ğŸ“¡ Site-to-Site í”„ë¡œí† ì½œ</h2>

            <div class="info-box">
                <h3>Site-to-Site(S2S) ê°œìš”</h3>
                <p>NiFi ì¸ìŠ¤í„´ìŠ¤ ê°„ ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ ë°ì´í„° ì „ì†¡ì„ ìœ„í•œ í”„ë¡œí† ì½œ</p>
            </div>

            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ”’ Push ë°©ì‹</h3>
                    <pre><code># Remote Process Group ì„¤ì •
URLs: https://remote-nifi:8443/nifi
Transport Protocol: RAW
Proxy Host: (blank)

# Input Port ì„¤ì •
Port Name: FromClusterA
Concurrent Tasks: 5</code></pre>
                </div>

                <div class="feature-card">
                    <h3>ğŸ“¥ Pull ë°©ì‹</h3>
                    <pre><code># Output Port ì„¤ì •
Port Name: ToClusterB
Concurrent Tasks: 5

# Remote Process Groupì—ì„œ Pull
URLs: https://source-nifi:8443/nifi
Transport Protocol: HTTP</code></pre>
                </div>
            </div>

            <h2>ğŸ”§ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬</h2>

            <div class="config-section">
                <h3>ë…¸ë“œ ì¶”ê°€ ì ˆì°¨</h3>
                <pre><code># 1. ìƒˆ ë…¸ë“œì— NiFi ì„¤ì¹˜
tar -xzf nifi-1.23.2-bin.tar.gz

# 2. í´ëŸ¬ìŠ¤í„° ì„¤ì • ë³µì‚¬
cp cluster-node/conf/nifi.properties new-node/conf/

# 3. ë…¸ë“œë³„ ê³ ìœ  ì„¤ì • ìˆ˜ì •
nifi.cluster.node.address=new-node.example.com
nifi.web.https.host=new-node.example.com

# 4. ì¸ì¦ì„œ ì„¤ì •
./bin/tls-toolkit.sh standalone \
  -n 'new-node.example.com' \
  -C 'CN=admin,OU=NIFI'

# 5. NiFi ì‹œì‘
./bin/nifi.sh start

# 6. í´ëŸ¬ìŠ¤í„° ì°¸ì—¬ í™•ì¸
curl -k https://new-node:8443/nifi-api/controller/cluster</code></pre>
            </div>

            <div class="config-section">
                <h3>ë…¸ë“œ ì œê±° ì ˆì°¨</h3>
                <pre><code># 1. ë…¸ë“œ ì—°ê²° í•´ì œ
PUT /nifi-api/controller/cluster/nodes/{id}
{
  "node": {
    "nodeId": "node-id",
    "status": "DISCONNECTING"
  }
}

# 2. ë…¸ë“œì—ì„œ NiFi ì¤‘ì§€
./bin/nifi.sh stop

# 3. í´ëŸ¬ìŠ¤í„°ì—ì„œ ë…¸ë“œ ì œê±°
DELETE /nifi-api/controller/cluster/nodes/{id}</code></pre>
            </div>

            <h2>ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë©”íŠ¸ë¦­</h2>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">95%</div>
                    <p><strong>í´ëŸ¬ìŠ¤í„° ê°€ìš©ì„±</strong></p>
                </div>
                <div class="metric-card">
                    <div class="metric-value">10GB/s</div>
                    <p><strong>ì²˜ë¦¬ëŸ‰</strong></p>
                </div>
                <div class="metric-card">
                    <div class="metric-value">< 100ms</div>
                    <p><strong>ë ˆì´í„´ì‹œ</strong></p>
                </div>
                <div class="metric-card">
                    <div class="metric-value">8 Nodes</div>
                    <p><strong>í™œì„± ë…¸ë“œ</strong></p>
                </div>
            </div>

            <div class="config-section">
                <h3>ëª¨ë‹ˆí„°ë§ ì„¤ì •</h3>
                <pre><code># Reporting Task ì„¤ì •
Name: MonitorMemory
Type: org.apache.nifi.reporting.ambari.AmbariReportingTask
Scheduling Strategy: Timer Driven
Run Schedule: 60 sec

# Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘
PrometheusReportingTask:
  - Port: 9092
  - Metrics Prefix: nifi_
  - Instance ID: ${hostname()}

# ì‹œìŠ¤í…œ ì§„ë‹¨
GET /nifi-api/system-diagnostics
{
  "systemDiagnostics": {
    "aggregateSnapshot": {
      "totalHeap": "8 GB",
      "usedHeap": "4.2 GB",
      "heapUtilization": "52.5%",
      "totalThreads": 150,
      "eventDrivenThreads": 10
    }
  }
}</code></pre>
            </div>

            <h2>âš¡ ì„±ëŠ¥ ìµœì í™”</h2>

            <div class="scaling-strategy">
                <h3>í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ íŠœë‹</h3>
                
                <div class="warning-box">
                    <h4>âš ï¸ ì£¼ìš” íŠœë‹ í¬ì¸íŠ¸</h4>
                    <ul>
                        <li><strong>Thread Pool í¬ê¸°:</strong> CPU ì½”ì–´ ìˆ˜ Ã— 2-4</li>
                        <li><strong>Connection í í¬ê¸°:</strong> ë©”ëª¨ë¦¬ ìš©ëŸ‰ì— ë”°ë¼ ì¡°ì •</li>
                        <li><strong>FlowFile Repository:</strong> SSD ì‚¬ìš© ê¶Œì¥</li>
                        <li><strong>Content Repository:</strong> ë‹¤ì¤‘ ë””ë ‰í† ë¦¬ë¡œ I/O ë¶„ì‚°</li>
                    </ul>
                </div>

                <pre><code># ì„±ëŠ¥ ìµœì í™” ì„¤ì •
# Thread Pools
nifi.flow.engine.threads=30
nifi.administrative.threads=10

# Repository ìµœì í™”
nifi.flowfile.repository.checkpoint.interval=2 min
nifi.content.repository.archive.enabled=false
nifi.provenance.repository.rollover.time=5 mins

# ë„¤íŠ¸ì›Œí¬ ìµœì í™”
nifi.cluster.node.connection.timeout=5 sec
nifi.cluster.node.read.timeout=5 sec
nifi.cluster.firewall.file=

# JVM íŠœë‹
java.arg.8=-XX:+UseG1GC
java.arg.9=-XX:MaxGCPauseMillis=200
java.arg.10=-XX:G1ReservePercent=20</code></pre>
            </div>

            <h2>ğŸ›¡ï¸ ê³ ê°€ìš©ì„± (HA) êµ¬ì„±</h2>

            <div class="feature-grid">
                <div class="feature-card">
                    <h3>ğŸ”„ ìë™ í˜ì¼ì˜¤ë²„</h3>
                    <ul>
                        <li>ë…¸ë“œ ì¥ì•  ìë™ ê°ì§€</li>
                        <li>ì‘ì—… ìë™ ì¬í• ë‹¹</li>
                        <li>Primary Node ìë™ ì„ ì¶œ</li>
                        <li>ë°ì´í„° ì†ì‹¤ ë°©ì§€</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h3>ğŸ’¾ ë°ì´í„° ë³µì œ</h3>
                    <ul>
                        <li>FlowFile ë³µì œë³¸ ìœ ì§€</li>
                        <li>ìƒíƒœ ì •ë³´ ë™ê¸°í™”</li>
                        <li>ì„¤ì • ìë™ ë°±ì—…</li>
                        <li>Provenance ë°ì´í„° ë³µì œ</li>
                    </ul>
                </div>
            </div>

            <div class="success-box">
                <h3>âœ… í´ëŸ¬ìŠ¤í„° êµ¬ì„± ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤</h3>
                <ul>
                    <li>ìµœì†Œ 3ê°œ ë…¸ë“œë¡œ í´ëŸ¬ìŠ¤í„° êµ¬ì„± (ì¿¼ëŸ¼ ìœ ì§€)</li>
                    <li>ZooKeeperëŠ” í™€ìˆ˜ ê°œ ë…¸ë“œë¡œ êµ¬ì„± (3, 5, 7)</li>
                    <li>ë…¸ë“œ ê°„ ì „ìš© ë„¤íŠ¸ì›Œí¬ êµ¬ì„±</li>
                    <li>ì •ê¸°ì ì¸ ë°±ì—… ë° ë³µêµ¬ í…ŒìŠ¤íŠ¸</li>
                    <li>ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
                    <li>ë¡œë“œ ë°¸ëŸ°ì„œë¥¼ í†µí•œ íŠ¸ë˜í”½ ë¶„ì‚°</li>
                </ul>
            </div>

        </div>
    </div>
</body>
</html>